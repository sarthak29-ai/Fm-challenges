const http = require('http'); const fs = require('fs'); const path = require('path'); const port = 8080; const mimeTypes = {'.html': 'text/html', '.js': 'text/javascript', '.css': 'text/css', '.json': 'application/json', '.png': 'image/png', '.jpg': 'image/jpg', '.svg': 'image/svg+xml', '.txt': 'text/plain'}; const serveFile = (filePath, res) => { const extname = path.extname(filePath); let contentType = mimeTypes[extname] || 'application/octet-stream'; fs.readFile(filePath, (error, content) => { if (error) { res.writeHead(500); res.end('Error: '+error.code); } else { res.writeHead(200, { 'Content-Type': contentType }); res.end(content, 'utf-8'); } }); }; http.createServer((req, res) => { let cleanUrl = req.url.split('?')[0]; try { cleanUrl = decodeURIComponent(cleanUrl); } catch(e){} let filePath = '.' + cleanUrl; fs.stat(filePath, (err, stats) => { if (err) { res.writeHead(404); res.end('404 Not Found'); return; } if (stats.isDirectory()) { const indexPath = path.join(filePath, 'index.html'); if (fs.existsSync(indexPath)) { serveFile(indexPath, res); } else { fs.readdir(filePath, (err, files) => { if (err) { res.writeHead(500); res.end('Error'); return; } let list = '<html><head><meta name="viewport" content="width=device-width,initial-scale=1"><style>body{font-family:monospace;padding:20px}a{display:block;padding:10px;text-decoration:none;color:#007bff;border-bottom:1px solid #eee}a:hover{background:#f8f9fa}</style></head><body><h3>Directory: '+cleanUrl+'</h3>'; if(cleanUrl!=='/') list+='<a href="../">Parent Directory</a>'; files.forEach(f => { let p = path.join(cleanUrl, f); list += '<a href="'+p+'">'+ (f.indexOf('.')>0?'FILE: ':'DIR: ') + f + '</a>'; }); res.writeHead(200, {'Content-Type': 'text/html'}); res.end(list); }); } } else { serveFile(filePath, res); } }); }).listen(port, () => { console.log('Server running on ' + port); });
